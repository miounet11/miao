Miaoda Cloud Service - Complete File Structure
================================================

cloud-service/
â”‚
â”œâ”€â”€ ğŸ“¦ Root Configuration Files
â”‚   â”œâ”€â”€ package.json                    # Dependencies, scripts, metadata
â”‚   â”œâ”€â”€ tsconfig.json                   # TypeScript compiler configuration
â”‚   â”œâ”€â”€ .env.example                    # Environment variables template
â”‚   â”œâ”€â”€ .gitignore                      # Git ignore patterns
â”‚   â”œâ”€â”€ jest.config.js                  # Jest test configuration
â”‚   â”œâ”€â”€ .eslintrc.js                    # ESLint rules
â”‚   â”œâ”€â”€ .prettierrc                     # Prettier formatting rules
â”‚   â”œâ”€â”€ nodemon.json                    # Nodemon dev server config
â”‚   â”œâ”€â”€ Dockerfile                      # Docker image definition
â”‚   â”œâ”€â”€ .dockerignore                   # Docker ignore patterns
â”‚   â””â”€â”€ docker-compose.yml              # Docker Compose orchestration
â”‚
â”œâ”€â”€ ğŸ“š Documentation
â”‚   â”œâ”€â”€ README.md                       # Main project documentation
â”‚   â”œâ”€â”€ QUICKSTART.md                   # 5-minute quick start guide
â”‚   â”œâ”€â”€ API.md                          # Complete API documentation
â”‚   â”œâ”€â”€ DEPLOYMENT.md                   # Production deployment guide
â”‚   â”œâ”€â”€ CHANGELOG.md                    # Version history and changes
â”‚   â”œâ”€â”€ PROJECT_SUMMARY.md              # Project overview and statistics
â”‚   â”œâ”€â”€ STRUCTURE.txt                   # This file - project structure
â”‚   â””â”€â”€ LICENSE                         # MIT License
â”‚
â”œâ”€â”€ ğŸ”§ Source Code (src/)
â”‚   â”‚
â”‚   â”œâ”€â”€ server.ts                       # Application entry point
â”‚   â”œâ”€â”€ app.ts                          # Express application setup
â”‚   â”‚
â”‚   â”œâ”€â”€ config/                         # Configuration modules
â”‚   â”‚   â”œâ”€â”€ env.ts                      # Environment variable validation
â”‚   â”‚   â””â”€â”€ database.ts                 # Database connection & initialization
â”‚   â”‚
â”‚   â”œâ”€â”€ routes/                         # API route handlers
â”‚   â”‚   â”œâ”€â”€ index.ts                    # Route aggregator
â”‚   â”‚   â”œâ”€â”€ auth.ts                     # Authentication endpoints
â”‚   â”‚   â”œâ”€â”€ config.ts                   # Model configuration endpoints
â”‚   â”‚   â”œâ”€â”€ user.ts                     # User management endpoints
â”‚   â”‚   â””â”€â”€ health.ts                   # Health check endpoint
â”‚   â”‚
â”‚   â”œâ”€â”€ middleware/                     # Express middleware
â”‚   â”‚   â”œâ”€â”€ auth.ts                     # JWT authentication middleware
â”‚   â”‚   â”œâ”€â”€ rateLimit.ts                # Rate limiting middleware
â”‚   â”‚   â”œâ”€â”€ errorHandler.ts             # Global error handler
â”‚   â”‚   â””â”€â”€ logger.ts                   # Request logging (Winston)
â”‚   â”‚
â”‚   â”œâ”€â”€ services/                       # Business logic layer
â”‚   â”‚   â”œâ”€â”€ authService.ts              # Authentication logic
â”‚   â”‚   â”œâ”€â”€ configService.ts            # Configuration management
â”‚   â”‚   â””â”€â”€ userService.ts              # User operations
â”‚   â”‚
â”‚   â”œâ”€â”€ models/                         # Database models
â”‚   â”‚   â”œâ”€â”€ User.ts                     # User model & operations
â”‚   â”‚   â”œâ”€â”€ ModelConfig.ts              # Model configuration model
â”‚   â”‚   â””â”€â”€ UserConfig.ts               # User configuration model
â”‚   â”‚
â”‚   â””â”€â”€ utils/                          # Utility functions
â”‚       â”œâ”€â”€ jwt.ts                      # JWT token utilities
â”‚       â”œâ”€â”€ hash.ts                     # Password hashing (bcrypt)
â”‚       â””â”€â”€ validation.ts               # Input validation schemas (Zod)
â”‚
â”œâ”€â”€ ğŸ—„ï¸ Database
â”‚   â”œâ”€â”€ migrations/
â”‚   â”‚   â””â”€â”€ 001_initial.sql             # Initial database schema
â”‚   â”‚
â”‚   â””â”€â”€ seeds/
â”‚       â””â”€â”€ default_models.sql          # Default model configurations
â”‚
â”œâ”€â”€ ğŸ§ª Tests (tests/)
â”‚   â”œâ”€â”€ setup.ts                        # Test environment setup
â”‚   â”œâ”€â”€ auth.test.ts                    # Authentication tests
â”‚   â”œâ”€â”€ config.test.ts                  # Configuration tests
â”‚   â””â”€â”€ user.test.ts                    # User management tests
â”‚
â”œâ”€â”€ ğŸ› ï¸ Scripts (scripts/)
â”‚   â”œâ”€â”€ migrate.ts                      # Database migration runner
â”‚   â”œâ”€â”€ seed.ts                         # Database seeding script
â”‚   â”œâ”€â”€ setup.sh                        # Quick setup script
â”‚   â”œâ”€â”€ dev.sh                          # Development helper
â”‚   â””â”€â”€ test.sh                         # Test runner with options
â”‚
â””â”€â”€ ğŸ“ Generated/Runtime (not in repo)
    â”œâ”€â”€ dist/                           # Compiled JavaScript (npm run build)
    â”œâ”€â”€ data/                           # SQLite database files
    â”‚   â””â”€â”€ miaoda.db                   # Main database
    â”œâ”€â”€ logs/                           # Application logs
    â”‚   â”œâ”€â”€ error.log                   # Error logs
    â”‚   â””â”€â”€ combined.log                # All logs
    â”œâ”€â”€ coverage/                       # Test coverage reports
    â””â”€â”€ node_modules/                   # Dependencies


File Count Summary
==================
Total Files: 49

By Category:
- Configuration: 11 files
- Documentation: 8 files
- Source Code: 27 files
- Database: 2 files
- Tests: 4 files
- Scripts: 5 files


Key Technologies
================
- Node.js 18+
- Express 4.18
- TypeScript 5.3
- SQLite (better-sqlite3)
- JWT (jsonwebtoken)
- bcrypt
- Zod
- Winston
- Jest
- Docker


API Endpoints
=============
Public:
  GET    /api/v1/health
  POST   /api/v1/auth/register
  POST   /api/v1/auth/login
  GET    /api/v1/config/models (optional auth)

Protected (require JWT):
  GET    /api/v1/user/profile
  POST   /api/v1/user/config
  GET    /api/v1/user/config
  DELETE /api/v1/user/config


Database Schema
===============
Tables:
  - users (id, email, password_hash, membership, created_at)
  - model_configs (id, provider, model, api_url, membership_required, enabled, created_at)
  - user_configs (id, user_id, config_json, updated_at)


Security Features
=================
âœ“ JWT authentication (7-day expiry)
âœ“ bcrypt password hashing (10 rounds)
âœ“ Rate limiting (5/15min auth, 100/15min general)
âœ“ Helmet.js security headers
âœ“ CORS configuration
âœ“ Input validation (Zod)
âœ“ SQL injection prevention
âœ“ Environment variable validation


Development Commands
====================
npm install              # Install dependencies
npm run dev              # Start development server
npm run build            # Build for production
npm start                # Start production server
npm test                 # Run tests with coverage
npm run test:watch       # Run tests in watch mode
npm run migrate          # Run database migrations
npm run seed             # Seed database
npm run lint             # Lint code
npm run format           # Format code


Docker Commands
===============
docker build -t miaoda-cloud-service .
docker-compose up -d
docker-compose logs -f
docker-compose down


Production Checklist
====================
â–¡ Set strong JWT_SECRET (32+ chars)
â–¡ Configure CORS_ORIGIN (not *)
â–¡ Use HTTPS/TLS
â–¡ Set NODE_ENV=production
â–¡ Enable firewall
â–¡ Setup database backups
â–¡ Configure log rotation
â–¡ Review rate limits
â–¡ Run npm audit


Project Status
==============
âœ… Complete and Production-Ready
Version: 1.0.0
License: MIT
Created: 2024-01-01
